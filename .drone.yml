kind: pipeline
name: drone

workspace:
  base: /opt
  path: src/first_project

steps:
  - name: build
    image: golang:1.12
    commands:
      - cd src
      - go build


  - name: publish
    image: plugins/docker
    repo: slowmoon/first-example # docker仓库地址
    secrets: [ docker_username, docker_password ]
    tags:
      - latest


  - name: scp
    image: appleboy/drone-scp
    settings:
      host: 35.220.222.205
      user: tomcat
      port: 22
      password:
        from_secret: ssh_password
      target:
        /home/tomcat/drone
      source:
        ./src/game-server

